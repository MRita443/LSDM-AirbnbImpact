### **Source Schema Definition**

This schema defines the set of relations exposed by the wrapper (Python ETL script).

```
S = {NYPD_Complaints, NYC_Rolling_Sales, Airbnb_Listings}
```

---

### **1. Source Relation: `NYPD_Complaints`**

**Source File:** `nypd-complaints.csv`

**Description:** Records of reported criminal complaints in New York City.

| Attribute | Data Type | Constraint | Description |
| --- | --- | --- | --- |
| **`complaint_id`** | `String` | **PK** | Unique identifier for the complaint (Source: `CMPLNT_NUM`) |
| `borough` | `String` |  | Borough name (e.g., 'BRONX', 'QUEENS') |
| `date_str` | `Date` |  | Date of the crime occurrence |
| `offense_status` | `String` |  | Status of the crime (e.g., 'COMPLETED', 'ATTEMPTED') |
| `offense_level` | `String` |  | Level of offense (e.g., 'FELONY', 'MISDEMEANOR') |
| `premise_pos` | `String` |  | Location category (e.g., 'INSIDE', 'FRONT OF') |
| `offense_type` | `String` |  | Description of the offense (e.g., 'GRAND LARCENY') |
| `premise_type` | `String` |  | Specific premise type (e.g., 'RESIDENCE - APT. HOUSE', 'PARK') |
| `victim_sex` | `String` |  | Gender of the victim ('M', 'F', 'E', 'D') |
| `victim_age_group` | `String` |  | Age bracket of the victim (e.g., '25-44') |
| `latitude` | `Float` |  | Latitude coordinate |
| `longitude` | `Float` |  | Longitude coordinate |

---

### **2. Source Relation: `NYC_Rolling_Sales`**

**Source File:** `data_clean/nyc-rolling-sales.csv`

**Description:** Real estate sales transactions in NYC.

**Wrapper Logic:** A primary key `sale_id` was generated during wrapping because the raw data lacked a Primary Key.

| Attribute | Data Type | Constraint | Description |
| --- | --- | --- | --- |
| **`sale_id`** | `Integer` | **PK** | Surrogate unique identifier generated by ETL script |
| `borough` | `String` |  | Mapped borough name (e.g., 'MANHATTAN') |
| `neighborhood` | `String` |  | Neighborhood name (normalized to uppercase) |
| `building_category` | `String` |  | Classification of the property (e.g., '01 ONE FAMILY DWELLINGS') |
| `total_units` | `Integer` |  | Total number of units in the property |
| `gross_sqft` | `Float` |  | Gross square footage of the property |
| `year_built` | `Integer` |  | Year the building was constructed |
| `sale_price` | `Float` |  | Sale price in USD (filtered > $10k) |
| `sale_date` | `Date` |  | Date the sale was finalized |

---

### **3. Source Relation: `Airbnb_Listings`**

**Source File:** `data_clean/nyc-airbnb/listings_detail.csv`

**Description:** Airbnb listing details including host information and availability metrics.

**Wrapper Logic:** Includes a derived attribute `host_is_outside_nyc`.

| Attribute | Data Type | Constraint | Description |
| --- | --- | --- | --- |
| **`listing_id`** | `String` | **PK** | Unique identifier for the listing |
| `scrape_date` | `Date` |  | Date the data was scraped |
| `listing_name` | `String` |  | Title of the listing |
| `host_id` | `String` |  | Unique identifier for the host |
| `host_since` | `Date` |  | Date the host joined Airbnb |
| `host_location` | `String` |  | Location string provided by the host |
| `host_neighborhood` | `String` |  | Host's self-reported neighborhood |
| `neighborhood` | `String` |  | Normalized neighborhood name |
| `borough` | `String` |  | Normalized borough name |
| `latitude` | `Float` |  | Latitude coordinate |
| `longitude` | `Float` |  | Longitude coordinate |
| `property_type` | `String` |  | Type of building (e.g., 'Apartment', 'House') |
| `room_type` | `String` |  | Type of room (e.g., 'Entire home/apt', 'Private room') |
| `capacity` | `Integer` |  | Maximum number of guests  |
| `square_feet` | `Float` |  | Size of the listing in square feet (often NULL) |
| `daily_price` | `Float` |  | Nightly price in USD |
| `min_nights` | `Integer` |  | Minimum stay required |
| `max_nights` | `Integer` |  | Maximum stay allowed |
| `availability_year` | `Integer` |  | Days available out of the next 365 |
| `first_review_date` | `Date` |  | Date of the first review |
| `last_review_date` | `Date` |  | Date of the most recent review |
| `location_score` | `Integer` |  | Review score for location (0-10) |
| `host_listings_count` | `Integer` |  | Number of listings managed by this host |
| `host_is_outside_nyc` | `Boolean` |  | **Derived:** True if `host_location` is not in NYC |